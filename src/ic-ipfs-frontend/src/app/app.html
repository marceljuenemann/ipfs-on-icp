<div class="container mt-4">
  <h1>IPFS on ICP</h1>




  <h2 class="mt-4">Upload</h2>

  <p>
    Selected files and directories will be split into IPFS blocks of no more than 1MB
    using the <a href="https://specs.ipfs.tech/unixfs/">UnixFS</a> standard.
  </p>

  <div class="mb-3">
    <input class="form-control" type="file" id="fileInput" (change)="onFileSelected($event)">
  </div>

  <div *ngIf="blocksToUpload()" class="alert alert-info mt-3">
    <div><b>Root CID:</b> {{ blocksToUpload()?.rootCid?.toString() }}</div>
    <div><b>Blocks:</b></div>
    <ul>
      @for (block of blocksToUpload()?.blocks ?? []; track block.cid.toString()) {
        <li>
          @let status = uploadStatus().get(block.cid.toString());
          @if (status) {
            @if (status === 'uploading') {
              <span class="badge bg-primary">uploading</span>
            } @else if (status === 'success') {
              <span class="badge bg-success">success</span>
            } @else if (status === 'duplicate') {
              <span class="badge bg-warning">duplicate</span>
            } @else {
              <span class="badge bg-danger">{{ status.error }}</span>
            }
          }

          {{ block.cid.toString() }} ({{ block.bytes.length }} bytes)
        </li>
      }
    </ul>
    <button class="btn btn-primary" (click)="uploadBlocks()">
      Upload
    </button>
  </div>


</div>
